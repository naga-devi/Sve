(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"jK+u":function(c,e,t){"use strict";t.r(e),t.d(e,"routes",(function(){return Qc})),t.d(e,"PurchasesModule",(function(){return Rc}));var r=t("ofXK"),a=t("tyNb"),o=t("PCNd"),i=t("oOf3"),n=t("3Pt+"),s=t("F5nt"),l=t("mIbC"),u=t("/RaO"),d=t("AytR"),m=t("0IaG"),b=t("fXoL"),p=t("Wp6s"),f=t("XiUz"),h=t("bTqV"),v=t("f0Cb");function g(c,e){if(1&c&&(b.cc(0,"div",6),b.cc(1,"div",7),b.Oc(2),b.bc(),b.cc(3,"div",7),b.Oc(4),b.bc(),b.cc(5,"div",7),b.Oc(6),b.bc(),b.cc(7,"div",7),b.Oc(8),b.bc(),b.cc(9,"div",7),b.Oc(10),b.bc(),b.cc(11,"div",7),b.Oc(12),b.bc(),b.cc(13,"div",7),b.Oc(14),b.bc(),b.cc(15,"div",7),b.Oc(16),b.bc(),b.cc(17,"div",7),b.Oc(18),b.bc(),b.cc(19,"div",7),b.Oc(20),b.bc(),b.cc(21,"div",7),b.Oc(22),b.bc(),b.cc(23,"div",7),b.Oc(24),b.bc(),b.cc(25,"div",7),b.Oc(26),b.pc(27,"number"),b.bc(),b.bc()),2&c){const c=e.$implicit;b.Jb(2),b.Pc(c.productName),b.Jb(2),b.Pc(c.categoryName),b.Jb(2),b.Pc(c.materialTypeName),b.Jb(2),b.Pc(c.sizeName),b.Jb(2),b.Pc(c.brandName),b.Jb(2),b.Pc(c.gradeName),b.Jb(2),b.Pc(c.colorName),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.mrp),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.unitPrice),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.cgstAmount),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.sgstAmount),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.stockedQty),b.Jb(2),b.Pc(b.rc(27,13,null==c||null==c.purchase?null:c.purchase.subTotal,"1.2-2"))}}let O=(()=>{class c{constructor(c,e,t,r){this.dialogRef=c,this.data=e,this.appService=t,this.alertService=r,this.purchaseItems=[]}ngOnInit(){this.getPurchaseItemsByOrderId()}getPurchaseItemsByOrderId(){this.appService.getBy(`purchasing/${this.data.order.purchaseOrderId}/details/view`).subscribe(c=>{this.purchaseItems=c},c=>{this.alertService.error(c)})}ngOnDestroy(){}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(m.h),b.Wb(m.a),b.Wb(s.a),b.Wb(l.NotificationService))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-details-list-dialog"]],decls:73,vars:8,consts:[[1,"p-1"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["mat-raised-button","","color","warn","type","button","mat-dialog-close",""],[1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],[1,"mat-row"],[1,"mat-cell"],[1,"order"],["class","mat-row",4,"ngFor","ngForOf"]],template:function(c,e){1&c&&(b.cc(0,"div",0),b.cc(1,"mat-dialog-content"),b.cc(2,"mat-card"),b.cc(3,"div",1),b.cc(4,"h2"),b.Oc(5),b.bc(),b.cc(6,"button",2),b.Oc(7,"Close"),b.bc(),b.bc(),b.Xb(8,"mat-divider"),b.cc(9,"mat-card-content"),b.cc(10,"div",3),b.cc(11,"div",4),b.cc(12,"div",5),b.Oc(13,"Invoice#"),b.bc(),b.cc(14,"div",5),b.Oc(15,"Company Name"),b.bc(),b.cc(16,"div",5),b.Oc(17,"Contact No."),b.bc(),b.cc(18,"div",5),b.Oc(19,"Purchase Date"),b.bc(),b.cc(20,"div",5),b.Oc(21,"Total"),b.bc(),b.bc(),b.cc(22,"div",6),b.cc(23,"div",7),b.cc(24,"span",8),b.Oc(25),b.bc(),b.bc(),b.cc(26,"div",7),b.Oc(27),b.bc(),b.cc(28,"div",7),b.Oc(29),b.bc(),b.cc(30,"div",7),b.Oc(31),b.bc(),b.cc(32,"div",7),b.cc(33,"strong"),b.Oc(34),b.bc(),b.Oc(35," for "),b.cc(36,"strong"),b.Oc(37),b.bc(),b.Oc(38," items"),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(39,"div",1),b.cc(40,"h2"),b.Oc(41,"Purchased Items"),b.bc(),b.bc(),b.Xb(42,"mat-divider"),b.cc(43,"mat-card-content"),b.cc(44,"div",3),b.cc(45,"div",4),b.cc(46,"div",5),b.Oc(47,"Product"),b.bc(),b.cc(48,"div",5),b.Oc(49,"Category"),b.bc(),b.cc(50,"div",5),b.Oc(51,"Material"),b.bc(),b.cc(52,"div",5),b.Oc(53,"Size"),b.bc(),b.cc(54,"div",5),b.Oc(55,"Brand"),b.bc(),b.cc(56,"div",5),b.Oc(57,"Grade"),b.bc(),b.cc(58,"div",5),b.Oc(59,"Color"),b.bc(),b.cc(60,"div",5),b.Oc(61,"MRP"),b.bc(),b.cc(62,"div",5),b.Oc(63,"UnitPrice"),b.bc(),b.cc(64,"div",5),b.Oc(65,"Cgst"),b.bc(),b.cc(66,"div",5),b.Oc(67,"Sgst"),b.bc(),b.cc(68,"div",5),b.Oc(69,"Quantity"),b.bc(),b.cc(70,"div",5),b.Oc(71,"Total"),b.bc(),b.bc(),b.Mc(72,g,28,16,"div",9),b.bc(),b.bc(),b.bc(),b.bc(),b.bc()),2&c&&(b.Jb(5),b.Qc("",e.data.order.companyName," Purchase Order"),b.Jb(20),b.Qc("#",e.data.order.invoiceNo,""),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.companyName),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.phoneNo),b.Jb(2),b.Pc(e.data.order.purchaseDate),b.Jb(3),b.Qc("\u20b9",e.data.order.grandTotal,""),b.Jb(3),b.Pc(e.data.order.stockedQty),b.Jb(35),b.vc("ngForOf",e.purchaseItems))},directives:[m.f,p.a,f.d,f.c,h.b,m.e,v.a,p.b,r.l],pipes:[r.f],styles:[""]}),c})();var y=t("kmnG"),I=t("qFsG"),N=t("iadO");const x=function(){return{standalone:!0}};function S(c,e){if(1&c){const c=b.dc();b.cc(0,"div",7),b.cc(1,"div",8),b.Oc(2),b.bc(),b.cc(3,"div",8),b.Oc(4),b.bc(),b.cc(5,"div",8),b.Oc(6),b.bc(),b.cc(7,"div",8),b.Oc(8),b.pc(9,"number"),b.bc(),b.cc(10,"div",8),b.cc(11,"mat-form-field",15),b.cc(12,"input",26),b.kc("input",(function(t){b.Fc(c);const r=e.$implicit;return b.oc().validateRejectedQty(t.target.value,r.purchase.receivedQty)}))("ngModelChange",(function(t){return b.Fc(c),e.$implicit.purchase.rejectedQty=t})),b.bc(),b.bc(),b.bc(),b.bc()}if(2&c){const c=e.$implicit;b.Jb(2),b.Sc("",c.categoryName," | ",c.productName," | ",c.materialTypeName," | ",c.sizeName," | ",c.brandName," | ",c.gradeName," | ",c.colorName,""),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.purchasedCost),b.Jb(2),b.Pc(null==c||null==c.purchase?null:c.purchase.receivedQty),b.Jb(2),b.Pc(b.rc(9,13,null==c||null==c.purchase?null:c.purchase.subTotal,"1.2-2")),b.Jb(4),b.vc("max",c.purchase.receivedQty)("ngModel",c.purchase.rejectedQty)("ngModelOptions",b.xc(16,x))}}function w(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Return date is required "),b.bc())}function P(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Sub Total is required "),b.bc())}function J(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Grand Total is required "),b.bc())}let C=(()=>{class c{constructor(c,e,t,r,a){this.dialogRef=c,this.data=e,this.appService=t,this.formBuilder=r,this.alertService=a,this.purchaseItems=[]}ngOnInit(){this.getPurchaseItemsByOrderId(),this.initForm()}getPurchaseItemsByOrderId(){this.appService.getBy(`purchasing/${this.data.order.purchaseOrderId}/details/view`).subscribe(c=>{this.purchaseItems=c},c=>{this.alertService.error(c)})}onReturnSave(){console.log(this.purchaseItems);let c=this.purchaseItems.filter(c=>parseInt(c.purchase.rejectedQty,0)>0);if(c&&c.length>0){let e=[];c.forEach(c=>{e.push(c.purchase)}),this.appService.postBy("purchasing/purchasereturns/create",{header:this.form.value,details:e}).subscribe(c=>{c.code===l.ResponseStatus.Success?(this.alertService.success(c.message),this.dialogRef.close({response:c})):this.alertService.error(c.message)},c=>{this.alertService.error(c)})}}ngOnDestroy(){}validateRejectedQty(c,e){let t=this.purchaseItems.filter(c=>parseInt(c.purchase.rejectedQty,0)>0);if(t&&t.length>0){let c=0;t.forEach(e=>{let t=parseInt(e.purchase.rejectedQty,0);c+=t*e.purchase.purchasedCost}),this.form.controls.totalAmount.setValue(c.toFixed(2))}const r=parseInt(c,0);return r<0||r>e?0:r}updateRoundOff(){const c=Number(this.form.controls.totalAmount.value),e=Number(this.form.controls.grandTotal.value);this.form.controls.roundOff.setValue((c-e).toFixed(2))}initForm(){this.form=this.formBuilder.group({purchaseOrderId:this.data.order.purchaseOrderId,returnDate:[new Date,n.v.required],totalAmount:[null,n.v.required],roundOff:[null,n.v.required],grandTotal:[null,n.v.required],remarks:[null]})}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(m.h),b.Wb(m.a),b.Wb(s.a),b.Wb(n.d),b.Wb(l.NotificationService))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-returns-edit-dialog"]],decls:98,vars:14,consts:[["autocomplete","off",3,"formGroup","ngSubmit"],[1,"p-1"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["mat-raised-button","","color","warn","type","button","mat-dialog-close",""],[1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],[1,"mat-row"],[1,"mat-cell"],[1,"order"],[1,"mat-header-cell",2,"width","500px"],["class","mat-row",4,"ngFor","ngForOf"],["fxLayout","row wrap"],["fxFlex","100",1,"px-2"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","readonly","","placeholder","Purchase Date","formControlName","returnDate",3,"matDatepicker"],["matSuffix","",3,"for"],["returnDate",""],[4,"ngIf"],["type","number","placeholder","0","readonly","","matInput","","formControlName","totalAmount"],["type","number","placeholder","0","matInput","","formControlName","grandTotal",3,"keyup"],["type","number","placeholder","0","matInput","","formControlName","roundOff","readonly",""],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","remarks","placeholder","Enter remarks"],["mat-raised-button","","color","primary","type","button",3,"click"],["type","number","placeholder","0","min","1","matInput","",3,"max","ngModel","ngModelOptions","input","ngModelChange"]],template:function(c,e){if(1&c&&(b.cc(0,"form",0),b.kc("ngSubmit",(function(){return e.onReturnSave()})),b.cc(1,"div",1),b.cc(2,"mat-dialog-content"),b.cc(3,"mat-card"),b.cc(4,"div",2),b.cc(5,"h2"),b.Oc(6),b.bc(),b.cc(7,"button",3),b.Oc(8,"Close"),b.bc(),b.bc(),b.Xb(9,"mat-divider"),b.cc(10,"mat-card-content"),b.cc(11,"div",4),b.cc(12,"div",5),b.cc(13,"div",6),b.Oc(14,"Invoice#"),b.bc(),b.cc(15,"div",6),b.Oc(16,"Company Name"),b.bc(),b.cc(17,"div",6),b.Oc(18,"Contact No."),b.bc(),b.cc(19,"div",6),b.Oc(20,"Purchase Date"),b.bc(),b.cc(21,"div",6),b.Oc(22,"Total"),b.bc(),b.bc(),b.cc(23,"div",7),b.cc(24,"div",8),b.cc(25,"span",9),b.Oc(26),b.bc(),b.bc(),b.cc(27,"div",8),b.Oc(28),b.bc(),b.cc(29,"div",8),b.Oc(30),b.bc(),b.cc(31,"div",8),b.Oc(32),b.bc(),b.cc(33,"div",8),b.cc(34,"strong"),b.Oc(35),b.bc(),b.Oc(36," for "),b.cc(37,"strong"),b.Oc(38),b.bc(),b.Oc(39," items "),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(40,"div",2),b.cc(41,"h2"),b.Oc(42,"Purchased Items"),b.bc(),b.bc(),b.Xb(43,"mat-divider"),b.cc(44,"mat-card-content"),b.cc(45,"div",4),b.cc(46,"div",5),b.cc(47,"div",10),b.Oc(48,"Product"),b.bc(),b.cc(49,"div",6),b.Oc(50,"MRP"),b.bc(),b.cc(51,"div",6),b.Oc(52,"Received Qty."),b.bc(),b.cc(53,"div",6),b.Oc(54,"Total"),b.bc(),b.cc(55,"div",6),b.Oc(56,"Return Qty."),b.bc(),b.bc(),b.Mc(57,S,13,17,"div",11),b.bc(),b.bc(),b.cc(58,"div",12),b.cc(59,"div",13),b.cc(60,"div",12),b.cc(61,"div",14),b.cc(62,"mat-form-field",15),b.cc(63,"mat-label"),b.Oc(64,"Return date"),b.bc(),b.Xb(65,"input",16),b.Xb(66,"mat-datepicker-toggle",17),b.Xb(67,"mat-datepicker",null,18),b.Mc(69,w,2,0,"mat-error",19),b.bc(),b.bc(),b.cc(70,"div",14),b.cc(71,"mat-form-field",15),b.cc(72,"mat-label"),b.Oc(73,"Sub Total"),b.bc(),b.Xb(74,"input",20),b.Mc(75,P,2,0,"mat-error",19),b.bc(),b.bc(),b.cc(76,"div",14),b.cc(77,"mat-form-field",15),b.cc(78,"mat-label"),b.Oc(79,"Grand Total"),b.bc(),b.cc(80,"input",21),b.kc("keyup",(function(){return e.updateRoundOff()})),b.bc(),b.Mc(81,J,2,0,"mat-error",19),b.bc(),b.bc(),b.cc(82,"div",14),b.cc(83,"mat-form-field",15),b.cc(84,"mat-label"),b.Oc(85,"Round Off"),b.bc(),b.Xb(86,"input",22),b.bc(),b.bc(),b.cc(87,"div",23),b.cc(88,"mat-form-field",15),b.cc(89,"mat-label"),b.Oc(90,"Remarks"),b.bc(),b.Xb(91,"input",24),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(92,"mat-card-footer"),b.cc(93,"div",2),b.cc(94,"button",3),b.Oc(95,"Cancel"),b.bc(),b.cc(96,"button",25),b.kc("click",(function(){return e.onReturnSave()})),b.Oc(97,"Save"),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc()),2&c){const c=b.Cc(68);b.vc("formGroup",e.form),b.Jb(6),b.Qc("",e.data.order.companyName," Purchase Order"),b.Jb(20),b.Qc("#",e.data.order.invoiceNo,""),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.companyName),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.phoneNo),b.Jb(2),b.Pc(e.data.order.purchaseDate),b.Jb(3),b.Qc("\u20b9",e.data.order.grandTotal,""),b.Jb(3),b.Pc(e.data.order.stockedQty),b.Jb(19),b.vc("ngForOf",e.purchaseItems),b.Jb(8),b.vc("matDatepicker",c),b.Jb(1),b.vc("for",c),b.Jb(3),b.vc("ngIf",null==e.form.controls.returnDate.errors?null:e.form.controls.returnDate.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.totalAmount.errors?null:e.form.controls.totalAmount.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.grandTotal.errors?null:e.form.controls.grandTotal.errors.required)}},directives:[n.w,n.p,n.i,m.f,p.a,f.d,f.c,h.b,m.e,v.a,p.b,r.l,f.a,y.c,y.g,I.b,n.c,N.b,n.o,n.g,N.d,y.h,N.a,r.m,n.s,p.c,n.r,y.b],pipes:[r.f],styles:[""]}),c})();function T(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Issue date is required "),b.bc())}function q(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Discount is required "),b.bc())}let F=(()=>{class c{constructor(c,e,t,r,a){this.dialogRef=c,this.data=e,this.appService=t,this.formBuilder=r,this.alertService=a,this.purchaseItems=[]}ngOnInit(){this.getPurchaseItemsByOrderId(),this.initForm()}getPurchaseItemsByOrderId(){this.appService.getBy(`purchasing/${this.data.order.purchaseOrderId}/details/view`).subscribe(c=>{this.purchaseItems=c},c=>{this.alertService.error(c)})}issueCreditNote(){let c=this.form.value;c.issueDate=Object(l.toServerDate)(c.issueDate),this.appService.postBy("purchasing/creditnotes/save-with-purchaseorder/"+this.data.order.purchaseOrderId,c).subscribe(c=>{c.code===l.ResponseStatus.Success?(this.alertService.success(c.message),this.dialogRef.close({response:c})):this.alertService.error(c.message)},c=>{this.alertService.error(c)})}ngOnDestroy(){}initForm(){this.form=this.formBuilder.group({vendorId:this.data.order.vendorId,purchaseOrderId:this.data.order.purchaseOrderId,issueDate:[new Date,n.v.required],currentBalance:["50000",n.v.required],discount:[null,n.v.required],remarks:[null]})}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(m.h),b.Wb(m.a),b.Wb(s.a),b.Wb(n.d),b.Wb(l.NotificationService))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-credit-note-edit-dialog"]],decls:77,vars:12,consts:[["autocomplete","off",3,"formGroup","ngSubmit"],[1,"p-1"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["mat-raised-button","","color","warn","type","button","mat-dialog-close",""],[1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],[1,"mat-row"],[1,"mat-cell"],[1,"order"],["fxLayout","row wrap"],["fxFlex","100",1,"px-2"],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["appearance","outline",1,"w-100"],["type","number","placeholder","0","readonly","","matInput","","formControlName","currentBalance"],["matInput","","readonly","","placeholder","Issue Date","formControlName","issueDate",3,"matDatepicker"],["matSuffix","",3,"for"],["issueDate",""],[4,"ngIf"],["type","number","placeholder","0","min","1","matInput","","formControlName","discount"],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","remarks","placeholder","Enter remarks"],["mat-raised-button","","color","primary","type","button",3,"click"]],template:function(c,e){if(1&c&&(b.cc(0,"form",0),b.kc("ngSubmit",(function(){return e.issueCreditNote()})),b.cc(1,"div",1),b.cc(2,"mat-dialog-content"),b.cc(3,"mat-card"),b.cc(4,"div",2),b.cc(5,"h2"),b.Oc(6),b.bc(),b.cc(7,"button",3),b.Oc(8,"Close"),b.bc(),b.bc(),b.Xb(9,"mat-divider"),b.cc(10,"mat-card-content"),b.cc(11,"div",4),b.cc(12,"div",5),b.cc(13,"div",6),b.Oc(14,"Invoice#"),b.bc(),b.cc(15,"div",6),b.Oc(16,"Company Name"),b.bc(),b.cc(17,"div",6),b.Oc(18,"Contact No."),b.bc(),b.cc(19,"div",6),b.Oc(20,"Purchase Date"),b.bc(),b.cc(21,"div",6),b.Oc(22,"Total"),b.bc(),b.bc(),b.cc(23,"div",7),b.cc(24,"div",8),b.cc(25,"span",9),b.Oc(26),b.bc(),b.bc(),b.cc(27,"div",8),b.Oc(28),b.bc(),b.cc(29,"div",8),b.Oc(30),b.bc(),b.cc(31,"div",8),b.Oc(32),b.bc(),b.cc(33,"div",8),b.cc(34,"strong"),b.Oc(35),b.bc(),b.Oc(36," for "),b.cc(37,"strong"),b.Oc(38),b.bc(),b.Oc(39," items "),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(40,"div",2),b.cc(41,"h2"),b.Oc(42,"Credit Note Issued Details"),b.bc(),b.bc(),b.cc(43,"div",10),b.cc(44,"div",11),b.cc(45,"div",10),b.cc(46,"div",12),b.cc(47,"mat-form-field",13),b.cc(48,"mat-label"),b.Oc(49,"Current Balance"),b.bc(),b.Xb(50,"input",14),b.bc(),b.bc(),b.cc(51,"div",12),b.cc(52,"mat-form-field",13),b.cc(53,"mat-label"),b.Oc(54,"Credit Issue Date"),b.bc(),b.Xb(55,"input",15),b.Xb(56,"mat-datepicker-toggle",16),b.Xb(57,"mat-datepicker",null,17),b.Mc(59,T,2,0,"mat-error",18),b.bc(),b.bc(),b.cc(60,"div",12),b.cc(61,"mat-form-field",13),b.cc(62,"mat-label"),b.Oc(63,"Discount"),b.bc(),b.Xb(64,"input",19),b.Mc(65,q,2,0,"mat-error",18),b.bc(),b.bc(),b.cc(66,"div",20),b.cc(67,"mat-form-field",13),b.cc(68,"mat-label"),b.Oc(69,"Remarks"),b.bc(),b.Xb(70,"input",21),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(71,"mat-card-footer"),b.cc(72,"div",2),b.cc(73,"button",3),b.Oc(74,"Cancel"),b.bc(),b.cc(75,"button",22),b.kc("click",(function(){return e.issueCreditNote()})),b.Oc(76,"Save"),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc()),2&c){const c=b.Cc(58);b.vc("formGroup",e.form),b.Jb(6),b.Qc("",e.data.order.companyName," Purchase Order"),b.Jb(20),b.Qc("#",e.data.order.invoiceNo,""),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.companyName),b.Jb(2),b.Pc(null==e.data.order?null:e.data.order.phoneNo),b.Jb(2),b.Pc(e.data.order.purchaseDate),b.Jb(3),b.Qc("\u20b9",e.data.order.grandTotal,""),b.Jb(3),b.Pc(e.data.order.stockedQty),b.Jb(17),b.vc("matDatepicker",c),b.Jb(1),b.vc("for",c),b.Jb(3),b.vc("ngIf",null==e.form.controls.issueDate.errors?null:e.form.controls.issueDate.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.discount.errors?null:e.form.controls.discount.errors.required)}},directives:[n.w,n.p,n.i,m.f,p.a,f.d,f.c,h.b,m.e,v.a,p.b,f.a,y.c,y.g,n.s,I.b,n.c,n.o,n.g,N.b,N.d,y.h,N.a,r.m,p.c,y.b],styles:[""]}),c})();var A=t("Dh3D"),k=t("Qu3c"),M=t("STbY"),D=t("NFeN");function B(c,e){if(1&c){const c=b.dc();b.cc(0,"div",16),b.cc(1,"div",17),b.cc(2,"span",18),b.Oc(3),b.bc(),b.bc(),b.cc(4,"div",17),b.Oc(5),b.bc(),b.cc(6,"div",17),b.Oc(7),b.bc(),b.cc(8,"div",17),b.Oc(9),b.bc(),b.cc(10,"div",17),b.cc(11,"strong"),b.Oc(12),b.bc(),b.Oc(13," for "),b.cc(14,"strong"),b.Oc(15),b.bc(),b.Oc(16," items"),b.bc(),b.cc(17,"div",17),b.cc(18,"div",19),b.cc(19,"button",20),b.cc(20,"mat-icon"),b.Oc(21,"more_vert"),b.bc(),b.bc(),b.cc(22,"mat-menu",null,21),b.cc(24,"button",22),b.kc("click",(function(){b.Fc(c);const t=e.$implicit;return b.oc().openOrderDetailsDialog(t)})),b.cc(25,"mat-icon"),b.Oc(26,"content_copy"),b.bc(),b.cc(27,"span"),b.Oc(28,"View"),b.bc(),b.bc(),b.cc(29,"button",22),b.kc("click",(function(){b.Fc(c);const t=e.$implicit;return b.oc().edit(t)})),b.cc(30,"mat-icon"),b.Oc(31,"edit"),b.bc(),b.cc(32,"span"),b.Oc(33,"Edit"),b.bc(),b.bc(),b.cc(34,"button",22),b.kc("click",(function(){b.Fc(c);const t=e.$implicit;return b.oc().returnOrder(t)})),b.cc(35,"mat-icon"),b.Oc(36,"history"),b.bc(),b.cc(37,"span"),b.Oc(38,"Return"),b.bc(),b.bc(),b.cc(39,"button",22),b.kc("click",(function(){b.Fc(c);const t=e.$implicit;return b.oc().issueCreditNote(t)})),b.cc(40,"mat-icon"),b.Oc(41,"payment"),b.bc(),b.cc(42,"span"),b.Oc(43,"Credit Note"),b.bc(),b.bc(),b.cc(44,"button",22),b.kc("click",(function(){b.Fc(c);const t=e.$implicit;return b.oc().deleteOrder(t)})),b.cc(45,"mat-icon"),b.Oc(46,"delete"),b.bc(),b.cc(47,"span"),b.Oc(48,"Delete"),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc()}if(2&c){const c=e.$implicit,t=b.Cc(23);b.Jb(3),b.Qc("#",c.invoiceNo,""),b.Jb(2),b.Pc(null==c?null:c.companyName),b.Jb(2),b.Pc(null==c?null:c.phoneNo),b.Jb(2),b.Pc(c.purchaseDate),b.Jb(3),b.Qc("\u20b9",c.grandTotal,""),b.Jb(3),b.Pc(c.stockedQty),b.Jb(4),b.vc("matMenuTriggerFor",t)}}function L(c,e){1&c&&(b.cc(0,"div",23),b.Oc(1,"No records found"),b.bc())}function Q(c,e){if(1&c){const c=b.dc();b.cc(0,"div",24),b.cc(1,"div",25),b.cc(2,"mat-card",26),b.cc(3,"pagination-controls",27),b.kc("pageChange",(function(e){return b.Fc(c),b.oc().onPageChanged(e)})),b.bc(),b.bc(),b.bc(),b.bc()}}const R=function(){return["/admin/purchases/add-purchase"]},W=function(c,e,t){return{itemsPerPage:c,currentPage:e,totalItems:t}};let X=(()=>{class c{constructor(c,e,t,r,a,o){this.appService=c,this.dialog=e,this.router=t,this.alertService=r,this.uploadDownloadService=a,this.appSettings=o,this.matTable={data:[],page:1,count:10,totalItems:0,sort:{direction:"desc",active:"purchaseDate"},filter:{InvoiceNo:""}},this.settings=this.appSettings.settings}ngOnInit(){this.getOrdersList()}getOrdersList(){const c=new l.QueryParamsModel(this.matTable.filter,this.matTable.sort.active,this.matTable.sort.direction,this.matTable.page||1,10);this.appService.postBy("purchasing/purchase-order/find",c).subscribe(c=>{this.matTable.data=c.items?c.items:[],this.matTable.totalItems=c.totalCount})}onPageChanged(c){this.matTable.page=c,window.scrollTo(0,0)}searchByOrderNo(c){0!=parseInt(c.target.value,0)&&(this.matTable.filter.InvoiceNo=c.target.value,this.getOrdersList())}openOrderDetailsDialog(c){this.dialog.open(O,{data:{order:c},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr",width:"80%"}).afterClosed().subscribe(c=>{})}returnOrder(c){this.dialog.open(C,{data:{order:c},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr",width:"80%"}).afterClosed().subscribe(c=>{})}issueCreditNote(c){this.dialog.open(F,{data:{order:c},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr",width:"80%"}).afterClosed().subscribe(c=>{})}edit(c){this.router.navigateByUrl("admin/purchases/edit/"+c.purchaseOrderId)}deleteOrder(c){this.appService.deleteBy("purchasing/purchase-order/delete/"+c.purchaseOrderId).subscribe(c=>{c.code===l.ResponseStatus.Success?(this.alertService.success(c.message),this.getOrdersList()):this.alertService.error(c.message)},c=>{this.alertService.error(c)})}downloadInvoice(c){this.uploadDownloadService.downloadFileFromApi(`${d.a.apiUrl}sales/orders/download-invoice/${c}`,c+"-invoice.pdf")}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(s.a),b.Wb(m.c),b.Wb(a.e),b.Wb(l.NotificationService),b.Wb(l.UploadDownloadService),b.Wb(u.a))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-orders"]],decls:30,vars:12,consts:[[1,"p-1"],[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["fxFlex","100%"],["name","searchform","autocomplete","off",1,"user-search"],["floatLabel","auto","hideRequiredMarker","","appearance","outline",1,"user-search-input"],["matInput","","type","number","placeholder","Search by order#...","name","search",3,"keydown.enter"],["mat-raised-button","","color","primary",3,"routerLink"],["matSort","",1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],["mat-sort-header","companyName",1,"mat-header-cell"],["mat-sort-header","purchaseDate",1,"mat-header-cell"],["class","mat-row",4,"ngFor","ngForOf"],["class","table-empty-row",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],[1,"mat-row"],[1,"mat-cell"],[1,"order"],[1,"p-1","actions"],["mat-icon-button","","matTooltip","More actions",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","type","button",3,"click"],[1,"table-empty-row"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","10",1,"product-pagination",3,"pageChange"]],template:function(c,e){1&c&&(b.cc(0,"div",0),b.cc(1,"mat-card",1),b.cc(2,"div",2),b.cc(3,"div",3),b.cc(4,"div",4),b.cc(5,"mat-form-field",5),b.cc(6,"input",6),b.kc("keydown.enter",(function(c){return e.searchByOrderNo(c)})),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.Xb(7,"mat-divider"),b.cc(8,"div",2),b.cc(9,"h2"),b.Oc(10,"Orders List"),b.bc(),b.cc(11,"a",7),b.Oc(12," Add Orders "),b.bc(),b.bc(),b.cc(13,"div",8),b.cc(14,"div",9),b.cc(15,"div",10),b.Oc(16,"Invoice#"),b.bc(),b.cc(17,"div",11),b.Oc(18,"Company Name"),b.bc(),b.cc(19,"div",10),b.Oc(20,"Contact No."),b.bc(),b.cc(21,"div",12),b.Oc(22,"Purchase Date"),b.bc(),b.cc(23,"div",10),b.Oc(24,"Total"),b.bc(),b.Xb(25,"div",10),b.bc(),b.Mc(26,B,49,7,"div",13),b.pc(27,"paginate"),b.bc(),b.Mc(28,L,2,0,"div",14),b.bc(),b.Mc(29,Q,4,0,"div",15),b.bc()),2&c&&(b.Jb(11),b.vc("routerLink",b.xc(7,R)),b.Jb(15),b.vc("ngForOf",b.rc(27,4,e.matTable.data,b.Ac(8,W,e.matTable.count,e.matTable.page,e.matTable.totalItems))),b.Jb(2),b.vc("ngIf",e.matTable.data&&0===e.matTable.data.length),b.Jb(1),b.vc("ngIf",e.matTable.data.length>0))},directives:[p.a,f.d,f.c,f.a,y.c,I.b,v.a,h.a,a.g,A.a,A.b,r.l,r.m,h.b,k.a,M.e,D.a,M.f,M.c,i.c],pipes:[i.b],styles:["mat-form-field.mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),c})();var $=t("d3UM"),G=t("FKr1"),V=t("vBMV");function z(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.id),b.Jb(2),b.Pc(c.name)}}function U(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Category is required"),b.bc())}function _(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.productId),b.Jb(2),b.Pc(c.name)}}function j(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Product is required"),b.bc())}function E(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.brandId),b.Jb(2),b.Pc(c.name)}}function K(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Brand is required"),b.bc())}function H(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.materialTypeId),b.Jb(2),b.Pc(c.name)}}function Y(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.sizeId),b.Jb(2),b.Pc(c.name)}}function Z(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Size is required"),b.bc())}function cc(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.gradeId),b.Jb(2),b.Pc(c.name)}}function ec(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.colorId),b.Jb(2),b.Pc(c.name)}}function tc(c,e){if(1&c&&(b.cc(0,"mat-option",13),b.cc(1,"span"),b.Oc(2),b.bc(),b.bc()),2&c){const c=e.$implicit;b.vc("value",c.unitMeasureId),b.Jb(2),b.Pc(c.name)}}function rc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"UnitMeasure is required"),b.bc())}function ac(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"MRP is required"),b.bc())}function oc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Quantity is required"),b.bc())}function ic(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"Unit price is required"),b.bc())}function nc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"CGST is required"),b.bc())}function sc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1,"SGST is required"),b.bc())}let lc=(()=>{class c{constructor(c,e,t,r){this.dialogRef=c,this.data=e,this.appService=t,this.fb=r,this.materialTypes=[],this.sizes=[],this.brands=[],this.products=[],this.grades=[],this.colors=[]}ngOnInit(){this.products=this.data.products,this.form=this.fb.group({id:0,categoryId:[null,n.v.required],productId:[null,n.v.required],materialTypeId:[null,n.v.required],sizeId:[null,n.v.required],brandId:[null,n.v.required],colorId:[1],gradeId:[1],unitMeasureId:[null,n.v.required],unitPrice:[null,n.v.required],receivedQty:[null,n.v.required],mrp:[null,n.v.required],totalCgstAmount:[null,n.v.required],totalSgstAmount:[null,n.v.required],taxableAmount:[null],cgstAmount:[null],sgstAmount:[null],totalAmount:[null],discount:[null],subtotal:[null]}),this.data.purchase&&(this.data.purchase.totalAmount=this.data.purchase.totalAmount||0,this.data.purchase.subtotal=this.data.purchase.subtotal||0,this.form.patchValue(this.data.purchase))}onProductFilter(c){let e=c.toLowerCase();this.products=this.data.products.filter(c=>c.categoryId==this.form.controls.categoryId.value&&parseInt(this.form.controls.categoryId.value,0)&&c.name.toLowerCase().startsWith(e))}updatePrice(){const c=Number(this.form.controls.unitPrice.value),e=Number(this.form.controls.receivedQty.value),t=Number(this.form.controls.discount.value);let r=0;const a=parseInt(this.form.controls.productId.value,0),o=this.products.filter(c=>c.productId==a)[0].taxSlabId,i=this.data.prerequisites.taxItems.filter(c=>c.taxSlabId===o)[0].cgst,n=this.data.prerequisites.taxItems.filter(c=>c.taxSlabId===o)[0].sgst;if(c>0&&i>0&&n>0){r=t>0?c-c*t/100:c;const a=i/100*r,o=n/100*r,s=r+a+o;this.form.controls.subtotal.setValue(Number(r).toFixed(2)),this.form.controls.cgstAmount.setValue(Number(a).toFixed(2)),this.form.controls.sgstAmount.setValue(Number(o).toFixed(2)),this.form.controls.totalAmount.setValue(Number(s).toFixed(2)),this.form.controls.totalCgstAmount.setValue(Number(a*e).toFixed(2)),this.form.controls.totalSgstAmount.setValue(Number(o*e).toFixed(2)),this.form.controls.taxableAmount.setValue(Number(r*e).toFixed(2))}}onSubmit(){this.form.valid&&this.dialogRef.close(this.form.value)}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(m.h),b.Wb(m.a),b.Wb(s.a),b.Wb(n.d))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-orders-add-purchase-item"]],decls:128,vars:43,consts:[["mat-dialog-title",""],["autocomplete","off",3,"formGroup","ngSubmit"],["mat-dialog-content",""],["fxLayout","row wrap",1,"mt-2"],["fxFlex","100","fxFlex.gt-sm","50",1,"px-1"],["appearance","outline",1,"w-100"],["formControlName","categoryId","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","productId","required",""],["placeholder","Search by name",1,"search-control",3,"keyup"],["fxFlex","100","fxFlex.gt-sm","20",1,"px-1"],["formControlName","brandId"],[3,"value"],["formControlName","materialTypeId"],["formControlName","sizeId"],["formControlName","gradeId"],["formControlName","colorId"],["formControlName","unitMeasureId"],["matInput","","formControlName","mrp","type","number"],["matInput","","formControlName","receivedQty","type","number"],["matInput","","formControlName","unitPrice","type","number",3,"keyup"],["matInput","","formControlName","discount","type","number",3,"keyup"],["matInput","","formControlName","subtotal","type","number","readonly",""],["matInput","","formControlName","totalCgstAmount","type","number"],["matInput","","formControlName","totalSgstAmount","type","number"],["matInput","","formControlName","taxableAmount","type","number","readonly",""],["mat-dialog-actions",""],["fxLayout","row","fxLayoutAlign","space-between center",1,"w-100"],["mat-raised-button","","color","warn","type","button","mat-dialog-close",""],["mat-raised-button","","color","primary","type","submit"]],template:function(c,e){1&c&&(b.cc(0,"h1",0),b.Oc(1,"Add stock"),b.bc(),b.cc(2,"form",1),b.kc("ngSubmit",(function(){return e.onSubmit()})),b.cc(3,"div",2),b.cc(4,"div",3),b.cc(5,"div",4),b.cc(6,"mat-form-field",5),b.cc(7,"mat-label"),b.Oc(8,"Category"),b.bc(),b.cc(9,"mat-select",6),b.Mc(10,z,3,2,"mat-option",7),b.bc(),b.Mc(11,U,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(12,"div",4),b.cc(13,"mat-form-field",5),b.cc(14,"mat-label"),b.Oc(15,"Product"),b.bc(),b.cc(16,"mat-select",9),b.cc(17,"input",10),b.kc("keyup",(function(c){return e.onProductFilter(c.target.value)})),b.bc(),b.Mc(18,_,3,2,"mat-option",7),b.pc(19,"filterByKey"),b.bc(),b.Mc(20,j,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(21,"div",11),b.cc(22,"mat-form-field",5),b.cc(23,"mat-label"),b.Oc(24,"Brands"),b.bc(),b.cc(25,"mat-select",12),b.cc(26,"mat-option",13),b.Oc(27,"-"),b.bc(),b.Mc(28,E,3,2,"mat-option",7),b.pc(29,"filterByKey"),b.bc(),b.Mc(30,K,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(31,"div",11),b.cc(32,"mat-form-field",5),b.cc(33,"mat-label"),b.Oc(34,"Material Type"),b.bc(),b.cc(35,"mat-select",14),b.cc(36,"mat-option",13),b.Oc(37,"-"),b.bc(),b.Mc(38,H,3,2,"mat-option",7),b.pc(39,"filterByKey"),b.bc(),b.bc(),b.bc(),b.cc(40,"div",11),b.cc(41,"mat-form-field",5),b.cc(42,"mat-label"),b.Oc(43,"Sizes"),b.bc(),b.cc(44,"mat-select",15),b.cc(45,"mat-option",13),b.Oc(46,"-"),b.bc(),b.Mc(47,Y,3,2,"mat-option",7),b.pc(48,"filterByKey"),b.bc(),b.Mc(49,Z,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(50,"div",11),b.cc(51,"mat-form-field",5),b.cc(52,"mat-label"),b.Oc(53,"Grades"),b.bc(),b.cc(54,"mat-select",16),b.cc(55,"mat-option",13),b.Oc(56,"-"),b.bc(),b.Mc(57,cc,3,2,"mat-option",7),b.pc(58,"filterByKey"),b.bc(),b.bc(),b.bc(),b.cc(59,"div",11),b.cc(60,"mat-form-field",5),b.cc(61,"mat-label"),b.Oc(62,"Colors"),b.bc(),b.cc(63,"mat-select",17),b.cc(64,"mat-option",13),b.Oc(65,"-"),b.bc(),b.Mc(66,ec,3,2,"mat-option",7),b.pc(67,"filterByKey"),b.bc(),b.bc(),b.bc(),b.cc(68,"div",11),b.cc(69,"mat-form-field",5),b.cc(70,"mat-label"),b.Oc(71,"UnitMeasure"),b.bc(),b.cc(72,"mat-select",18),b.cc(73,"mat-option",13),b.Oc(74,"-"),b.bc(),b.Mc(75,tc,3,2,"mat-option",7),b.bc(),b.Mc(76,rc,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(77,"div",11),b.cc(78,"mat-form-field",5),b.cc(79,"mat-label"),b.Oc(80,"MRP"),b.bc(),b.Xb(81,"input",19),b.Mc(82,ac,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(83,"div",11),b.cc(84,"mat-form-field",5),b.cc(85,"mat-label"),b.Oc(86,"Quantity"),b.bc(),b.Xb(87,"input",20),b.Mc(88,oc,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(89,"div",11),b.cc(90,"mat-form-field",5),b.cc(91,"mat-label"),b.Oc(92,"Unit Price"),b.bc(),b.cc(93,"input",21),b.kc("keyup",(function(){return e.updatePrice()})),b.bc(),b.Mc(94,ic,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(95,"div",11),b.cc(96,"mat-form-field",5),b.cc(97,"mat-label"),b.Oc(98,"Discount(%)"),b.bc(),b.cc(99,"input",22),b.kc("keyup",(function(){return e.updatePrice()})),b.bc(),b.bc(),b.bc(),b.cc(100,"div",11),b.cc(101,"mat-form-field",5),b.cc(102,"mat-label"),b.Oc(103,"Sub Total"),b.bc(),b.Xb(104,"input",23),b.bc(),b.bc(),b.cc(105,"div",11),b.cc(106,"mat-form-field",5),b.cc(107,"mat-label"),b.Oc(108,"Total CGST"),b.bc(),b.Xb(109,"input",24),b.Mc(110,nc,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(111,"div",11),b.cc(112,"mat-form-field",5),b.cc(113,"mat-label"),b.Oc(114,"Total SGST"),b.bc(),b.Xb(115,"input",25),b.Mc(116,sc,2,0,"mat-error",8),b.bc(),b.bc(),b.cc(117,"div",11),b.cc(118,"mat-form-field",5),b.cc(119,"mat-label"),b.Oc(120,"Taxable Amount"),b.bc(),b.Xb(121,"input",26),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(122,"div",27),b.cc(123,"div",28),b.cc(124,"button",29),b.Oc(125,"Close"),b.bc(),b.cc(126,"button",30),b.Oc(127,"Save"),b.bc(),b.bc(),b.bc(),b.bc()),2&c&&(b.Jb(2),b.vc("formGroup",e.form),b.Jb(8),b.vc("ngForOf",e.data.prerequisites.categories),b.Jb(1),b.vc("ngIf",null==e.form.controls.categoryId.errors?null:e.form.controls.categoryId.errors.required),b.Jb(7),b.vc("ngForOf",b.sc(19,19,e.products,"categoryId",e.form.get("categoryId").value)),b.Jb(2),b.vc("ngIf",null==e.form.controls.productId.errors?null:e.form.controls.productId.errors.required),b.Jb(8),b.vc("ngForOf",b.sc(29,23,e.data.prerequisites.brands,"categoryId",e.form.get("categoryId").value)),b.Jb(2),b.vc("ngIf",null==e.form.controls.brandId.errors?null:e.form.controls.brandId.errors.required),b.Jb(8),b.vc("ngForOf",b.sc(39,27,e.data.prerequisites.materialTypes,"categoryId",e.form.get("categoryId").value)),b.Jb(9),b.vc("ngForOf",b.sc(48,31,e.data.prerequisites.sizes,"categoryId",e.form.get("categoryId").value)),b.Jb(2),b.vc("ngIf",null==e.form.controls.sizeId.errors?null:e.form.controls.sizeId.errors.required),b.Jb(8),b.vc("ngForOf",b.sc(58,35,e.data.prerequisites.grades,"categoryId",e.form.get("categoryId").value)),b.Jb(9),b.vc("ngForOf",b.sc(67,39,e.data.prerequisites.colors,"categoryId",e.form.get("categoryId").value)),b.Jb(9),b.vc("ngForOf",e.data.unitmeasures),b.Jb(1),b.vc("ngIf",null==e.form.controls.unitMeasureId.errors?null:e.form.controls.unitMeasureId.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.mrp.errors?null:e.form.controls.mrp.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.receivedQty.errors?null:e.form.controls.receivedQty.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.unitPrice.errors?null:e.form.controls.unitPrice.errors.required),b.Jb(16),b.vc("ngIf",null==e.form.controls.totalCgstAmount.errors?null:e.form.controls.totalCgstAmount.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.totalSgstAmount.errors?null:e.form.controls.totalSgstAmount.errors.required))},directives:[m.i,n.w,n.p,n.i,m.f,f.d,f.a,y.c,y.g,$.a,n.o,n.g,n.u,r.l,r.m,G.n,I.b,n.c,n.s,m.d,f.c,h.b,m.e,y.b],pipes:[V.b],styles:[".search-control[_ngcontent-%COMP%]{font:inherit;background:transparent;color:currentColor;border:none;outline:none;padding:15px;margin:0;width:100%;max-width:100%;vertical-align:bottom;text-align:inherit}"]}),c})();var uc=t("ZokB");function dc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," TinNo is required "),b.bc())}function mc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Company Name is required "),b.bc())}function bc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Company Name isn't long enough, minimum of 4 characters "),b.bc())}function pc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Contact No is required "),b.bc())}function fc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Email is required "),b.bc())}function hc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Address No is required "),b.bc())}function vc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Invoice No is required "),b.bc())}function gc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Purchase date is required "),b.bc())}function Oc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Total is required "),b.bc())}function yc(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," NetAmount is required "),b.bc())}function Ic(c,e){1&c&&(b.cc(0,"mat-error"),b.Oc(1," Grand Total is required "),b.bc())}function Nc(c,e){if(1&c){const c=b.dc();b.cc(0,"div",35),b.cc(1,"div",36),b.Oc(2),b.pc(3,"filterById"),b.bc(),b.cc(4,"div",36),b.Oc(5),b.pc(6,"filterById"),b.bc(),b.cc(7,"div",36),b.Oc(8),b.pc(9,"filterById"),b.bc(),b.cc(10,"div",36),b.Oc(11),b.pc(12,"filterById"),b.bc(),b.cc(13,"div",36),b.Oc(14),b.pc(15,"filterById"),b.bc(),b.cc(16,"div",36),b.Oc(17),b.pc(18,"filterById"),b.bc(),b.cc(19,"div",36),b.Oc(20),b.pc(21,"filterById"),b.bc(),b.cc(22,"div",36),b.Oc(23),b.pc(24,"filterById"),b.bc(),b.cc(25,"div",36),b.Oc(26),b.bc(),b.cc(27,"div",36),b.Oc(28),b.bc(),b.cc(29,"div",36),b.Oc(30),b.bc(),b.cc(31,"div",36),b.Oc(32),b.bc(),b.cc(33,"div",36),b.Oc(34),b.bc(),b.cc(35,"div",36),b.Oc(36),b.bc(),b.cc(37,"div",36),b.cc(38,"div",37),b.cc(39,"button",38),b.cc(40,"mat-icon"),b.Oc(41,"more_vert"),b.bc(),b.bc(),b.cc(42,"mat-menu",null,39),b.cc(44,"button",40),b.kc("click",(function(){b.Fc(c);const t=e.$implicit,r=e.index;return b.oc().openAddItemDialog(t,r,!1)})),b.cc(45,"mat-icon"),b.Oc(46,"edit"),b.bc(),b.cc(47,"span"),b.Oc(48,"Edit"),b.bc(),b.bc(),b.cc(49,"button",40),b.kc("click",(function(){b.Fc(c);const t=e.$implicit,r=e.index;return b.oc().remove(t,r)})),b.cc(50,"mat-icon"),b.Oc(51,"delete"),b.bc(),b.cc(52,"span"),b.Oc(53,"Delete"),b.bc(),b.bc(),b.cc(54,"button",40),b.kc("click",(function(){b.Fc(c);const t=e.$implicit,r=e.index;return b.oc().copyPurchaseItem(t,r)})),b.cc(55,"mat-icon"),b.Oc(56,"content_copy"),b.bc(),b.cc(57,"span"),b.Oc(58,"Copy"),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc()}if(2&c){const c=e.$implicit,u=b.Cc(43),d=b.oc();var t,r,a,o,i,n,s,l;b.Jb(2),b.Pc(null==(t=b.sc(3,15,d.products,c.productId,"productId"))?null:t.name),b.Jb(3),b.Pc(null==(r=b.rc(6,19,null==d.prerequisites?null:d.prerequisites.categories,c.categoryId))?null:r.name),b.Jb(3),b.Pc(null==(a=b.sc(9,22,null==d.prerequisites?null:d.prerequisites.materialTypes,c.materialTypeId,"materialTypeId"))?null:a.name),b.Jb(3),b.Pc(null==(o=b.sc(12,26,null==d.prerequisites?null:d.prerequisites.sizes,c.sizeId,"sizeId"))?null:o.name),b.Jb(3),b.Pc(null==(i=b.sc(15,30,null==d.prerequisites?null:d.prerequisites.brands,c.brandId,"brandId"))?null:i.name),b.Jb(3),b.Pc(null==(n=b.sc(18,34,null==d.prerequisites?null:d.prerequisites.grades,c.gradeId,"gradeId"))?null:n.name),b.Jb(3),b.Pc(null==(s=b.sc(21,38,null==d.prerequisites?null:d.prerequisites.colors,c.colorId,"colorId"))?null:s.name),b.Jb(3),b.Pc(null==(l=b.sc(24,42,d.unitmeasures,c.unitMeasureId,"unitMeasureId"))?null:l.name),b.Jb(3),b.Pc(c.receivedQty),b.Jb(2),b.Pc(c.mrp),b.Jb(2),b.Pc(c.unitPrice),b.Jb(2),b.Pc(c.totalCgstAmount),b.Jb(2),b.Pc(c.totalSgstAmount),b.Jb(2),b.Pc(c.taxableAmount),b.Jb(3),b.vc("matMenuTriggerFor",u)}}function xc(c,e){1&c&&(b.cc(0,"div",41),b.Oc(1,"No records found"),b.bc())}function Sc(c,e){if(1&c){const c=b.dc();b.cc(0,"mat-card-content"),b.cc(1,"div",42),b.cc(2,"button",43),b.kc("click",(function(){return b.Fc(c),b.oc().onSubmit()})),b.Oc(3,"Confirm"),b.bc(),b.bc(),b.bc()}}const wc=function(){return["/admin/purchases/orders"]};let Pc=(()=>{class c{constructor(c,e,t,r,a,o,i){this.appService=c,this.appSettings=e,this.formBuilder=t,this.dialog=r,this.alertService=a,this.activatedRoute=o,this.router=i,this.overAllDiscountPercentage=.09,this.purchases=[],this.prerequisites={},this.products=[],this.unitmeasures=[],this.totalAmount=0,this.subTotal=0,this.purchaseOrderId=0,this.setNetAmount=()=>{this.totalAmount=0;let c=0,e=0,t=0;this.purchases.forEach(c=>{this.totalAmount=Number(this.totalAmount)+Number(c.taxableAmount),e+=Number(c.totalCgstAmount),t+=Number(c.totalSgstAmount)});const r=Number(this.form.controls.discount.value),a=Number(this.form.controls.roundOffAmount.value);r>0?(c=this.totalAmount-r,e=c*this.overAllDiscountPercentage,t=c*this.overAllDiscountPercentage):c=this.totalAmount,this.subTotal=c+e+t;const o=this.subTotal-a;this.form.patchValue({totalAmount:0===this.totalAmount?null:this.totalAmount.toFixed(2),netAmount:c.toFixed(2),cgstAmount:0===e?null:e.toFixed(2),sgstAmount:0===t?null:t.toFixed(2),subTotal:this.subTotal.toFixed(2),grandTotal:o.toFixed(2),roundOffAmount:0})},this.getUnitMeasures=()=>{this.appService.getBy("product/unitmeasure/all").subscribe(c=>{this.unitmeasures=c},c=>{this.alertService.error(c)})},this.settings=this.appSettings.settings}ngOnInit(){if(this.initForm(),this.loadPreRequisites(),this.loadAllProducts(),this.getUnitMeasures(),this.sub=this.activatedRoute.params.subscribe(c=>{c.id&&(this.purchaseOrderId=c.id,this.getPurchaseOrderById())}),0==this.purchaseOrderId){const c=this.getOrderFromLS();c&&(this.form.patchValue(c.header),this.purchases=c.details)}}getPurchaseOrderById(){this.appService.getBy("purchasing/purchase-order/edit/"+this.purchaseOrderId).subscribe(c=>{this.orderToEdit=c,this.form.patchValue(c),this.purchases=c.details},c=>{this.alertService.error(c)})}initForm(){this.form=this.formBuilder.group({vendorId:0,purchaseOrderId:0,companyName:[null,n.v.compose([n.v.required,n.v.minLength(4)])],tinNo:[null],email:[null],phoneNo:[null,n.v.required],address:[null,n.v.required],invoiceNo:[null,n.v.required],purchaseDate:[new Date,n.v.required],totalAmount:[null,n.v.required],discount:[null],netAmount:[null,n.v.required],cgstAmount:[null],sgstAmount:[null],subTotal:[null,n.v.required],roundOffAmount:[null],grandTotal:[null,n.v.required]}),this.form.valueChanges.subscribe(c=>{this.setOrderInLS()})}updateRoundOff(){const c=Number(this.form.controls.subTotal.value),e=Number(this.form.controls.grandTotal.value);this.form.controls.roundOffAmount.setValue((c-e).toFixed(2)),this.setOrderInLS()}loadPreRequisites(){this.appService.getBy("v1/cart/filter-types/0").subscribe(c=>{this.prerequisites=c},c=>{this.alertService.error(c)})}loadAllProducts(){this.appService.getBy("product/productdetails/all").subscribe(c=>{this.products=c},c=>{this.alertService.error(c)})}openAddItemDialog(c,e,t){this.dialog.open(lc,{data:{purchase:c,products:this.products,prerequisites:this.prerequisites,unitmeasures:this.unitmeasures},panelClass:["theme-dialog"],autoFocus:!0,direction:this.settings.rtl?"rtl":"ltr"}).afterClosed().subscribe(c=>{c&&(t?this.purchases.push(c):this.purchases[e]=c,this.setNetAmount(),this.setOrderInLS())})}remove(c,e){this.dialog.open(uc.a,{maxWidth:"400px",data:{title:"Confirm Action",message:"Are you sure you want remove this purchase?"}}).afterClosed().subscribe(c=>{c&&(this.purchases.splice(e,1),this.setNetAmount(),this.setOrderInLS())})}getVendorByTinNo(){this.appService.getBy("purchasing/vendors/tin-no/"+this.form.controls.tinNo.value).subscribe(c=>{this.form.patchValue(null===c?{}:c)})}getVendorByPhone(){parseInt(this.form.controls.vendorId.value,0)>0||this.appService.getBy("purchasing/vendors/phone-number/"+this.form.controls.phoneNo.value).subscribe(c=>{this.form.patchValue(null===c?{}:c)})}onSubmit(){if(this.purchases.length>0&&this.form.valid){let c=this.form.value;c.discount=Number(c.discount),c.cgstAmount=Number(c.cgstAmount),c.sgstAmount=Number(c.sgstAmount),c.purchaseDate&&(c.purchaseDate=Object(l.toServerDate)(c.purchaseDate)),this.appService.postBy("purchasing/purchase-order/save",{purchases:this.purchases,vendor:c}).subscribe(c=>{c.code===l.ResponseStatus.Success?(this.alertService.success(c.message),this.setOrderInLS(!0),this.router.navigate(["/admin/purchases/orders"])):this.alertService.error(c.message)},c=>{this.alertService.error(c)})}}copyPurchaseItem(c,e){c.id=0,this.openAddItemDialog(c,e,!0)}ngOnDestroy(){this.sub.unsubscribe()}setOrderInLS(c=!1){localStorage.setItem("sve_purchase_order_head",JSON.stringify({header:this.form.value,details:this.purchases})),c&&localStorage.removeItem("sve_purchase_order_head")}getOrderFromLS(){const c=localStorage.getItem("sve_purchase_order_head");return c?JSON.parse(c):null}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(s.a),b.Wb(u.a),b.Wb(n.d),b.Wb(m.c),b.Wb(l.NotificationService),b.Wb(a.a),b.Wb(a.e))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-add-order"]],decls:138,vars:20,consts:[[1,"p-1"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["mat-raised-button","","color","warn",3,"routerLink"],["fxLayout","row wrap"],["autocomplete","off",3,"formGroup","ngSubmit"],["fxFlex","100",1,"px-2"],["fxFlex","100","fxFlex.gt-sm","20",1,"px-1"],["appearance","outline",1,"w-100"],["matInput","","formControlName","tinNo","required","",3,"change"],[4,"ngIf"],["fxFlex","100","fxFlex.gt-sm","30",1,"px-1"],["matInput","","formControlName","companyName","required",""],["matInput","","formControlName","phoneNo","required","",3,"change"],["matInput","","formControlName","email","required",""],["fxFlex","100","fxFlex.gt-sm","100",1,"px-1"],["matInput","","formControlName","address","required","","placeholder","Address (street, apartment, suite, unit etc.)"],["fxFlex","100","fxFlex.gt-sm","33.3",1,"px-1"],["matInput","","formControlName","invoiceNo","required",""],["matInput","","readonly","","placeholder","Purchase Date","formControlName","purchaseDate",3,"matDatepicker"],["matSuffix","",3,"for"],["purchaseDate",""],["type","number","matInput","","formControlName","totalAmount","required","","readonly",""],["fxFlex","100","fxFlex.gt-sm","25",1,"px-1"],["type","number","matInput","","formControlName","discount",3,"keyup"],["type","number","readonly","","matInput","","formControlName","netAmount","required",""],["type","number","matInput","","formControlName","cgstAmount","readonly",""],["type","number","matInput","","formControlName","sgstAmount","readonly",""],["type","number","matInput","","formControlName","grandTotal",3,"keyup"],["type","number","matInput","","formControlName","roundOffAmount","readonly",""],["mat-raised-button","","color","primary",3,"click"],[1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],["class","mat-row",4,"ngFor","ngForOf"],["class","table-empty-row",4,"ngIf"],[1,"mat-row"],[1,"mat-cell"],[1,"p-1","actions"],["mat-icon-button","","matTooltip","More actions",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","","type","button",3,"click"],[1,"table-empty-row"],["fxFlex","100",1,"mt-2","text-center","w-100"],["mat-raised-button","","color","primary","type","submit",3,"click"]],template:function(c,e){if(1&c&&(b.cc(0,"div",0),b.cc(1,"mat-card"),b.cc(2,"div",1),b.cc(3,"h2"),b.Oc(4),b.bc(),b.cc(5,"a",2),b.Oc(6,"Back to orders "),b.bc(),b.bc(),b.cc(7,"mat-card-content"),b.cc(8,"div",3),b.cc(9,"form",4),b.kc("ngSubmit",(function(){return e.onSubmit()})),b.cc(10,"div",5),b.cc(11,"div",3),b.cc(12,"div",6),b.cc(13,"mat-form-field",7),b.cc(14,"mat-label"),b.Oc(15,"TIN No"),b.bc(),b.cc(16,"input",8),b.kc("change",(function(){return e.getVendorByTinNo()})),b.bc(),b.Mc(17,dc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(18,"div",10),b.cc(19,"mat-form-field",7),b.cc(20,"mat-label"),b.Oc(21,"Company Name"),b.bc(),b.Xb(22,"input",11),b.Mc(23,mc,2,0,"mat-error",9),b.Mc(24,bc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(25,"div",6),b.cc(26,"mat-form-field",7),b.cc(27,"mat-label"),b.Oc(28,"Contact No"),b.bc(),b.cc(29,"input",12),b.kc("change",(function(){return e.getVendorByPhone()})),b.bc(),b.Mc(30,pc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(31,"div",10),b.cc(32,"mat-form-field",7),b.cc(33,"mat-label"),b.Oc(34,"Email"),b.bc(),b.Xb(35,"input",13),b.Mc(36,fc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(37,"div",14),b.cc(38,"mat-form-field",7),b.cc(39,"mat-label"),b.Oc(40,"Address"),b.bc(),b.Xb(41,"input",15),b.Mc(42,hc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(43,"div",16),b.cc(44,"mat-form-field",7),b.cc(45,"mat-label"),b.Oc(46,"Invoice#"),b.bc(),b.Xb(47,"input",17),b.Mc(48,vc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(49,"div",16),b.cc(50,"mat-form-field",7),b.cc(51,"mat-label"),b.Oc(52,"Purchase date"),b.bc(),b.Xb(53,"input",18),b.Xb(54,"mat-datepicker-toggle",19),b.Xb(55,"mat-datepicker",null,20),b.Mc(57,gc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(58,"div",16),b.cc(59,"mat-form-field",7),b.cc(60,"mat-label"),b.Oc(61,"Total"),b.bc(),b.Xb(62,"input",21),b.Mc(63,Oc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(64,"div",22),b.cc(65,"mat-form-field",7),b.cc(66,"mat-label"),b.Oc(67,"Discount"),b.bc(),b.cc(68,"input",23),b.kc("keyup",(function(){return e.setNetAmount()})),b.bc(),b.bc(),b.bc(),b.cc(69,"div",22),b.cc(70,"mat-form-field",7),b.cc(71,"mat-label"),b.Oc(72,"Net Amount"),b.bc(),b.Xb(73,"input",24),b.Mc(74,yc,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(75,"div",22),b.cc(76,"mat-form-field",7),b.cc(77,"mat-label"),b.Oc(78,"CGST(9%)"),b.bc(),b.Xb(79,"input",25),b.bc(),b.bc(),b.cc(80,"div",22),b.cc(81,"mat-form-field",7),b.cc(82,"mat-label"),b.Oc(83,"SGST(9%)"),b.bc(),b.Xb(84,"input",26),b.bc(),b.bc(),b.cc(85,"div",22),b.cc(86,"mat-form-field",7),b.cc(87,"mat-label"),b.Oc(88,"Grand Total"),b.bc(),b.cc(89,"input",27),b.kc("keyup",(function(){return e.updateRoundOff()})),b.bc(),b.Mc(90,Ic,2,0,"mat-error",9),b.bc(),b.bc(),b.cc(91,"div",22),b.cc(92,"mat-form-field",7),b.cc(93,"mat-label"),b.Oc(94,"Round Off"),b.bc(),b.Xb(95,"input",28),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.cc(96,"div",1),b.cc(97,"h2"),b.Oc(98,"Purchased Product List"),b.bc(),b.cc(99,"button",29),b.kc("click",(function(){return e.openAddItemDialog(null,-1,!0)})),b.Oc(100,"Add Purchase Item"),b.bc(),b.bc(),b.Xb(101,"mat-divider"),b.cc(102,"mat-card-content"),b.cc(103,"div",30),b.cc(104,"div",31),b.cc(105,"div",32),b.Oc(106,"Product"),b.bc(),b.cc(107,"div",32),b.Oc(108,"Category"),b.bc(),b.cc(109,"div",32),b.Oc(110,"Material"),b.bc(),b.cc(111,"div",32),b.Oc(112,"Size"),b.bc(),b.cc(113,"div",32),b.Oc(114,"Brand"),b.bc(),b.cc(115,"div",32),b.Oc(116,"Grade"),b.bc(),b.cc(117,"div",32),b.Oc(118,"Color"),b.bc(),b.cc(119,"div",32),b.Oc(120,"UM"),b.bc(),b.cc(121,"div",32),b.Oc(122,"Quantity"),b.bc(),b.cc(123,"div",32),b.Oc(124,"MRP"),b.bc(),b.cc(125,"div",32),b.Oc(126,"UnitPrice"),b.bc(),b.cc(127,"div",32),b.Oc(128,"CGST"),b.bc(),b.cc(129,"div",32),b.Oc(130,"SGST"),b.bc(),b.cc(131,"div",32),b.Oc(132,"Taxable Amount"),b.bc(),b.cc(133,"div",32),b.Oc(134,"Actions"),b.bc(),b.bc(),b.Mc(135,Nc,59,46,"div",33),b.bc(),b.Mc(136,xc,2,0,"div",34),b.bc(),b.Mc(137,Sc,4,0,"mat-card-content",9),b.bc(),b.bc()),2&c){const c=b.Cc(56);b.Jb(4),b.Qc("",e.productId?"Edit":"Add New"," Purchases"),b.Jb(1),b.vc("routerLink",b.xc(19,wc)),b.Jb(4),b.vc("formGroup",e.form),b.Jb(8),b.vc("ngIf",null==e.form.controls.tinNo.errors?null:e.form.controls.tinNo.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.companyName.errors?null:e.form.controls.companyName.errors.required),b.Jb(1),b.vc("ngIf",e.form.controls.companyName.hasError("minlength")),b.Jb(6),b.vc("ngIf",null==e.form.controls.phoneNo.errors?null:e.form.controls.phoneNo.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.email.errors?null:e.form.controls.email.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.address.errors?null:e.form.controls.address.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.invoiceNo.errors?null:e.form.controls.invoiceNo.errors.required),b.Jb(5),b.vc("matDatepicker",c),b.Jb(1),b.vc("for",c),b.Jb(3),b.vc("ngIf",null==e.form.controls.purchaseDate.errors?null:e.form.controls.purchaseDate.errors.required),b.Jb(6),b.vc("ngIf",null==e.form.controls.totalAmount.errors?null:e.form.controls.totalAmount.errors.required),b.Jb(11),b.vc("ngIf",null==e.form.controls.netAmount.errors?null:e.form.controls.netAmount.errors.required),b.Jb(16),b.vc("ngIf",null==e.form.controls.grandTotal.errors?null:e.form.controls.grandTotal.errors.required),b.Jb(45),b.vc("ngForOf",e.purchases),b.Jb(1),b.vc("ngIf",e.purchases&&0===e.purchases.length),b.Jb(1),b.vc("ngIf",e.purchases.length>0&&e.form.valid)}},directives:[p.a,f.d,f.c,h.a,a.g,p.b,n.w,n.p,n.i,f.a,y.c,y.g,I.b,n.c,n.o,n.g,n.u,r.m,N.b,N.d,y.h,N.a,n.s,h.b,v.a,r.l,y.b,k.a,M.e,D.a,M.f,M.c],pipes:[V.a],styles:[""]}),c})();function Jc(c,e){if(1&c&&(b.cc(0,"div",15),b.cc(1,"div",16),b.cc(2,"a",17),b.Oc(3),b.bc(),b.bc(),b.cc(4,"div",16),b.Oc(5),b.bc(),b.cc(6,"div",16),b.Oc(7),b.pc(8,"date"),b.bc(),b.cc(9,"div",16),b.Oc(10),b.bc(),b.cc(11,"div",16),b.Oc(12),b.bc(),b.cc(13,"div",16),b.Oc(14),b.bc(),b.bc()),2&c){const c=e.$implicit;b.Jb(3),b.Qc("#",null==c||null==c.purchaseOrder?null:c.purchaseOrder.invoiceNo,""),b.Jb(2),b.Pc(null==c||null==c.purchaseOrder||null==c.purchaseOrder.vendor?null:c.purchaseOrder.vendor.companyName),b.Jb(2),b.Pc(b.qc(8,6,c.returnDate)),b.Jb(3),b.Pc(c.totalAmount),b.Jb(2),b.Pc(c.roundOff),b.Jb(2),b.Pc(c.totalAmount)}}function Cc(c,e){1&c&&(b.cc(0,"div",18),b.Oc(1,"No records found"),b.bc())}function Tc(c,e){if(1&c){const c=b.dc();b.cc(0,"div",19),b.cc(1,"div",20),b.cc(2,"mat-card",21),b.cc(3,"pagination-controls",22),b.kc("pageChange",(function(e){return b.Fc(c),b.oc().onPageChanged(e)})),b.bc(),b.bc(),b.bc(),b.bc()}}const qc=function(c,e,t){return{itemsPerPage:c,currentPage:e,totalItems:t}};let Fc=(()=>{class c{constructor(c,e,t,r,a,o){this.appService=c,this.dialog=e,this.router=t,this.alertService=r,this.uploadDownloadService=a,this.appSettings=o,this.matTable={data:[],page:1,count:10,totalItems:0,sort:{direction:"desc",active:"returnDate"},filter:{InvoiceNo:""}},this.settings=this.appSettings.settings}ngOnInit(){this.getOrdersList()}getOrdersList(){const c=new l.QueryParamsModel(this.matTable.filter,this.matTable.sort.active,this.matTable.sort.direction,this.matTable.page||1,10);this.appService.postBy("purchasing/purchasereturns/find",c).subscribe(c=>{this.matTable.data=c.items?c.items:[],this.matTable.totalItems=c.totalCount})}onPageChanged(c){this.matTable.page=c,window.scrollTo(0,0)}searchByOrderNo(c){0!=parseInt(c.target.value,0)&&(this.matTable.filter.InvoiceNo=c.target.value,this.getOrdersList())}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(s.a),b.Wb(m.c),b.Wb(a.e),b.Wb(l.NotificationService),b.Wb(l.UploadDownloadService),b.Wb(u.a))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-purchases-returns"]],decls:26,vars:10,consts:[[1,"p-1"],[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["fxFlex","100%"],["name","searchform","autocomplete","off",1,"user-search"],["floatLabel","auto","hideRequiredMarker","","appearance","outline",1,"user-search-input"],["matInput","","type","number","placeholder","Search by Return ID...","name","search",3,"keydown.enter"],["matSort","",1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],["mat-sort-header","companyName",1,"mat-header-cell"],["mat-sort-header","ReturnDate",1,"mat-header-cell"],["class","mat-row",4,"ngFor","ngForOf"],["class","table-empty-row",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],[1,"mat-row"],[1,"mat-cell"],["href","javascript:void(0)",1,"primary-text"],[1,"table-empty-row"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","10",1,"product-pagination",3,"pageChange"]],template:function(c,e){1&c&&(b.cc(0,"div",0),b.cc(1,"mat-card",1),b.cc(2,"div",2),b.cc(3,"div",3),b.cc(4,"div",4),b.cc(5,"mat-form-field",5),b.cc(6,"input",6),b.kc("keydown.enter",(function(c){return e.searchByOrderNo(c)})),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.Xb(7,"mat-divider"),b.cc(8,"div",7),b.cc(9,"div",8),b.cc(10,"div",9),b.Oc(11,"Invoice#"),b.bc(),b.cc(12,"div",10),b.Oc(13,"Company Name"),b.bc(),b.cc(14,"div",11),b.Oc(15,"Returned Date"),b.bc(),b.cc(16,"div",9),b.Oc(17,"Total Amount"),b.bc(),b.cc(18,"div",9),b.Oc(19,"RoundOff Amount"),b.bc(),b.cc(20,"div",9),b.Oc(21,"Grand Total"),b.bc(),b.bc(),b.Mc(22,Jc,15,8,"div",12),b.pc(23,"paginate"),b.bc(),b.Mc(24,Cc,2,0,"div",13),b.bc(),b.Mc(25,Tc,4,0,"div",14),b.bc()),2&c&&(b.Jb(22),b.vc("ngForOf",b.rc(23,3,e.matTable.data,b.Ac(6,qc,e.matTable.count,e.matTable.page,e.matTable.totalItems))),b.Jb(2),b.vc("ngIf",e.matTable.data&&0===e.matTable.data.length),b.Jb(1),b.vc("ngIf",e.matTable.data.length>0))},directives:[p.a,f.d,f.c,f.a,y.c,I.b,v.a,A.a,A.b,r.l,r.m,i.c],pipes:[i.b,r.e],styles:["mat-form-field.mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),c})();function Ac(c,e){if(1&c&&(b.cc(0,"a",20),b.Oc(1),b.bc()),2&c){const c=e.$implicit;b.Jb(1),b.Qc("#",c.purchaseOrderId,"")}}function kc(c,e){if(1&c&&(b.cc(0,"span"),b.Mc(1,Ac,2,1,"a",19),b.bc()),2&c){const c=b.oc().$implicit;b.Jb(1),b.vc("ngForOf",null==c?null:c.creditOrders)}}function Mc(c,e){if(1&c&&(b.cc(0,"div",15),b.cc(1,"div",16),b.cc(2,"span",17),b.Oc(3),b.bc(),b.bc(),b.cc(4,"div",16),b.Oc(5),b.bc(),b.cc(6,"div",16),b.Oc(7),b.pc(8,"date"),b.bc(),b.cc(9,"div",16),b.Oc(10),b.bc(),b.cc(11,"div",16),b.Mc(12,kc,2,1,"span",18),b.bc(),b.cc(13,"div",16),b.Oc(14),b.bc(),b.bc()),2&c){const c=e.$implicit;b.Jb(3),b.Qc("#",c.creditNoteId,""),b.Jb(2),b.Pc(null==c||null==c.vendor?null:c.vendor.companyName),b.Jb(2),b.Pc(b.qc(8,6,null==c?null:c.issueDate)),b.Jb(3),b.Pc(c.discount),b.Jb(2),b.vc("ngIf",null==c?null:c.creditOrders),b.Jb(2),b.Pc(c.remarks)}}function Dc(c,e){1&c&&(b.cc(0,"div",21),b.Oc(1,"No records found"),b.bc())}function Bc(c,e){if(1&c){const c=b.dc();b.cc(0,"div",22),b.cc(1,"div",23),b.cc(2,"mat-card",24),b.cc(3,"pagination-controls",25),b.kc("pageChange",(function(e){return b.Fc(c),b.oc().onPageChanged(e)})),b.bc(),b.bc(),b.bc(),b.bc()}}const Lc=function(c,e,t){return{itemsPerPage:c,currentPage:e,totalItems:t}},Qc=[{path:"",redirectTo:"orders",pathMatch:"full"},{path:"orders",component:X,data:{breadcrumb:"Purchase Orders"}},{path:"add-purchase",component:Pc,data:{breadcrumb:"Add Purchase order"}},{path:"edit/:id",component:Pc,data:{breadcrumb:"Edit purchase order"}},{path:"credit-notes",component:(()=>{class c{constructor(c,e,t,r,a,o){this.appService=c,this.dialog=e,this.router=t,this.alertService=r,this.uploadDownloadService=a,this.appSettings=o,this.matTable={data:[],page:1,count:10,totalItems:0,sort:{direction:"desc",active:"issueDate"},filter:{creditNoteId:""}},this.settings=this.appSettings.settings}ngOnInit(){this.getCreditnotes()}getCreditnotes(){const c=new l.QueryParamsModel(this.matTable.filter,this.matTable.sort.active,this.matTable.sort.direction,this.matTable.page||1,10);this.appService.postBy("purchasing/creditnotes/find",c).subscribe(c=>{this.matTable.data=c.items?c.items:[],this.matTable.totalItems=c.totalCount})}onPageChanged(c){this.matTable.page=c,window.scrollTo(0,0)}searchByOrderNo(c){0!=parseInt(c.target.value,0)&&(this.matTable.filter.creditNoteId=c.target.value,this.getCreditnotes())}openOrderDetailsDialog(c){this.dialog.open(O,{data:{order:c},panelClass:["theme-dialog"],autoFocus:!1,direction:this.settings.rtl?"rtl":"ltr",width:"80%"}).afterClosed().subscribe(c=>{})}}return c.\u0275fac=function(e){return new(e||c)(b.Wb(s.a),b.Wb(m.c),b.Wb(a.e),b.Wb(l.NotificationService),b.Wb(l.UploadDownloadService),b.Wb(u.a))},c.\u0275cmp=b.Qb({type:c,selectors:[["app-creditnote-list"]],decls:26,vars:10,consts:[[1,"p-1"],[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","space-between center",1,"w-100","p-2"],["fxFlex","100%"],["name","searchform","autocomplete","off",1,"user-search"],["floatLabel","auto","hideRequiredMarker","","appearance","outline",1,"user-search-input"],["matInput","","type","number","placeholder","Search by Credit Note ID...","name","search",3,"keydown.enter"],["matSort","",1,"mat-table","admin-table"],[1,"mat-header-row"],[1,"mat-header-cell"],["mat-sort-header","companyName",1,"mat-header-cell"],["mat-sort-header","IssueDate",1,"mat-header-cell"],["class","mat-row",4,"ngFor","ngForOf"],["class","table-empty-row",4,"ngIf"],["fxLayout","row wrap",4,"ngIf"],[1,"mat-row"],[1,"mat-cell"],[1,"order"],[4,"ngIf"],["href","javascript:void(0)","class","primary-text",4,"ngFor","ngForOf"],["href","javascript:void(0)",1,"primary-text"],[1,"table-empty-row"],["fxLayout","row wrap"],["fxFlex","100"],[1,"p-0","text-center"],["autoHide","true","maxSize","10",1,"product-pagination",3,"pageChange"]],template:function(c,e){1&c&&(b.cc(0,"div",0),b.cc(1,"mat-card",1),b.cc(2,"div",2),b.cc(3,"div",3),b.cc(4,"div",4),b.cc(5,"mat-form-field",5),b.cc(6,"input",6),b.kc("keydown.enter",(function(c){return e.searchByOrderNo(c)})),b.bc(),b.bc(),b.bc(),b.bc(),b.bc(),b.Xb(7,"mat-divider"),b.cc(8,"div",7),b.cc(9,"div",8),b.cc(10,"div",9),b.Oc(11,"CreditNote ID"),b.bc(),b.cc(12,"div",10),b.Oc(13,"Company Name"),b.bc(),b.cc(14,"div",11),b.Oc(15,"Issue Date"),b.bc(),b.cc(16,"div",9),b.Oc(17,"Discount"),b.bc(),b.cc(18,"div",9),b.Oc(19,"Order IDs"),b.bc(),b.cc(20,"div",9),b.Oc(21,"Remarks"),b.bc(),b.bc(),b.Mc(22,Mc,15,8,"div",12),b.pc(23,"paginate"),b.bc(),b.Mc(24,Dc,2,0,"div",13),b.bc(),b.Mc(25,Bc,4,0,"div",14),b.bc()),2&c&&(b.Jb(22),b.vc("ngForOf",b.rc(23,3,e.matTable.data,b.Ac(6,Lc,e.matTable.count,e.matTable.page,e.matTable.totalItems))),b.Jb(2),b.vc("ngIf",e.matTable.data&&0===e.matTable.data.length),b.Jb(1),b.vc("ngIf",e.matTable.data.length>0))},directives:[p.a,f.d,f.c,f.a,y.c,I.b,v.a,A.a,A.b,r.l,r.m,i.c],pipes:[i.b,r.e],styles:["mat-form-field.mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),c})(),data:{breadcrumb:"Credit Notes"}},{path:"purchase-returns",component:Fc,data:{breadcrumb:"Purchase Returns"}}];let Rc=(()=>{class c{}return c.\u0275mod=b.Ub({type:c}),c.\u0275inj=b.Tb({factory:function(e){return new(e||c)},imports:[[r.c,l.JxNetCoreModule,n.j,a.h.forChild(Qc),o.a,n.t,i.a]]}),c})()}}]);